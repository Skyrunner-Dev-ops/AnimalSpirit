<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Psychological AI Terminal</title>

    <style>
        body {
            margin: 0;
            background: #0d0d0d;
            color: #00ff88;
            font-family: monospace;
        }

        #terminal {
            padding: 20px;
            height: 95vh;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        input {
            background: black;
            border: none;
            color: #00ff88;
            font-family: monospace;
            font-size: 16px;
            outline: none;
        }

        .prompt {
            display: inline;
        }
    </style>
</head>

<body>

<div id="terminal"></div>

<script>
const terminal = document.getElementById("terminal");

let userName = "";
let gameStarted = false;
let questionIndex = 0;
let questionStartTime = 0;
let overrideCount = 0;
let savedResult = "";

let scores = {
    leadership: 0,
    logic: 0,
    risk: 0,
    empathy: 0,
    stability: 0,
    vision: 0,
    chaos: 0,
    stress: 0
};

const questions = [
    { q:"Do you naturally take leadership in group situations?", t:"leadership" },
    { q:"Do you rely more on logic than emotion?", t:"logic" },
    { q:"Do you enjoy taking calculated risks?", t:"risk" },
    { q:"Do you deeply understand othersâ€™ emotions?", t:"empathy" },
    { q:"Do you remain calm during chaos?", t:"stability" },
    { q:"Do you think long-term instead of short-term?", t:"vision" },
    { q:"Do you trust instincts over rules?", t:"risk" },
    { q:"Do you prefer solitude over crowds?", t:"logic" },
    { q:"Would you protect others at personal cost?", t:"leadership" },
    { q:"Do you adapt quickly to unexpected change?", t:"stability" },
    { q:"Production failure at 3AM. Take control immediately?", t:"stress" },
    { q:"Choose loyalty over logic?", t:"empathy" },
    { q:"Under isolation pressure, act immediately?", t:"stress" },
    { q:"Confront unfair blame directly?", t:"leadership" },
    { q:"Sacrifice one value to protect many?", t:"vision" }
];

function print(text="") {
    const line = document.createElement("div");
    line.textContent = text;
    terminal.appendChild(line);
    terminal.scrollTop = terminal.scrollHeight;
}

function typePrint(text, speed=15) {
    return new Promise(resolve => {
        const line = document.createElement("div");
        terminal.appendChild(line);
        let i = 0;

        function type() {
            if (i < text.length) {
                line.textContent += text.charAt(i);
                i++;
                setTimeout(type, speed);
            } else {
                resolve();
            }
        }
        type();
    });
}

function createInput() {
    const line = document.createElement("div");
    const span = document.createElement("span");
    span.textContent = " > ";
    span.className = "prompt";

    const input = document.createElement("input");
    input.autofocus = true;

    line.appendChild(span);
    line.appendChild(input);
    terminal.appendChild(line);
    terminal.scrollTop = terminal.scrollHeight;

    input.focus();

    input.addEventListener("keydown", function(e){
        if(e.key === "Enter") {
            const value = input.value;
            line.removeChild(input);
            handleInput(value.trim());
        }
    });
}

async function startGame() {
    await typePrint("root@kali:~# ./psychological_ai_test");
    await typePrint("Initializing neural matrix...");
    await typePrint("Enter your codename:");
    createInput();
}

function handleInput(value) {

    // EXPORT
    if (value.toLowerCase() === "export") {
        if (savedResult !== "") {
            try {
                navigator.clipboard.writeText(savedResult);
                print("Result copied.");
            } catch {
                print(savedResult);
            }
            createInput();
        } else {
            print("No result available yet.");
            createInput();
        }
        return;
    }

    // NAME
    if (!gameStarted) {
        if (value.length < 2) {
            print("Codename invalid.");
            createInput();
            return;
        }

        userName = value;
        gameStarted = true;

        print(`Identity locked: ${userName}`);
        print("Calibration starting...");

        setTimeout(askQuestion, 800);
        return;
    }

    processAnswer(value);
}

function askQuestion() {
    if (questionIndex >= questions.length) {
        showResult();
        return;
    }

    const q = questions[questionIndex];

    print("");
    print("-------------------------------------------------");
    print(q.q);
    print("1 = Yes 2 = No 3 = Override 4 = Not Sure");

    questionStartTime = Date.now();
    createInput();
}

function processAnswer(value) {
    if (!["1","2","3","4"].includes(value)) {
        print("");
        print("INPUT ERROR:");
        print("Only enter 1 2 3 4");
        createInput();
        return;
    }

    const responseTime = (Date.now() - questionStartTime)/1000;

    if (responseTime < 2) scores.risk++;
    if (responseTime > 7) scores.logic++;

    const trait = questions[questionIndex].t;

    if (value === "1") scores[trait]+=2;
    if (value === "2") scores.stability+=1;
    if (value === "3") {
        overrideCount++;
        scores.chaos+=2;
        glitch();
    }
    if (value === "4") scores.logic+=1;

    questionIndex++;
    askQuestion();
}

function glitch() {
    document.body.style.background="#220000";
    setTimeout(()=>{ document.body.style.background="#0d0d0d"; },150);
}

function getWinner() {
    if (scores.chaos > 6 && scores.risk > 6) return "Dragon";
    if (scores.stress > 6 && scores.vision > 6) return "Phoenix";

    const values = Object.values(scores);
    const max = Math.max(...values);
    const min = Math.min(...values);

    if ((max-min)<3) return "Griffin";

    const maxTrait = Object.keys(scores).reduce((a,b)=>scores[a]>scores[b]?a:b);

    const map = {
        leadership:"Wolf",
        logic:"Owl",
        risk:"Tiger",
        empathy:"Dolphin",
        stability:"Turtle",
        vision:"Eagle"
    };

    return map[maxTrait] || "Wolf";
}

function showResult() {

    const winner = getWinner();

    savedResult = `
=====================================
SPIRIT ANIMAL PROFILE REPORT
=====================================
Subject: ${userName}
Archetype: ${winner.toUpperCase()}

Leadership: ${scores.leadership}
Logic: ${scores.logic}
Risk: ${scores.risk}
Empathy: ${scores.empathy}
Stability: ${scores.stability}
Vision: ${scores.vision}
Stress: ${scores.stress}
Chaos Index: ${scores.chaos}

Session: ${Math.floor(Math.random()*100000)}
Date: ${new Date().toLocaleDateString()}
=====================================
`;

    print("");
    print("Analyzing neural signature...");

    setTimeout(() => {
        print(savedResult);
        print("");
        print("Type 'export' to copy report.");
        createInput();
    }, 1000);
}

window.onload = startGame;
</script>

</body>
</html>
